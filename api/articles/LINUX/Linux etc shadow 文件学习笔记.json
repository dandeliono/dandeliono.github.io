{"title":"Linux etc shadow 文件学习笔记","uid":"7c083edc735a96bb85e82e86710ce6ee","slug":"LINUX/Linux etc shadow 文件学习笔记","date":"2025-08-05T17:33:14.000Z","updated":"2025-12-05T01:46:59.689Z","comments":true,"path":"api/articles/LINUX/Linux etc shadow 文件学习笔记.json","keywords":"XuGuangSheng","cover":"/covers/linux-etc-shadow.jpg","content":"<h1 id=\"Linux-x2F-etc-x2F-shadow-文件学习笔记\"><a href=\"#Linux-x2F-etc-x2F-shadow-文件学习笔记\" class=\"headerlink\" title=\"Linux &#x2F;etc&#x2F;shadow 文件学习笔记\"></a>Linux &#x2F;etc&#x2F;shadow 文件学习笔记</h1><p>Linux系统下，创建的用户信息如ID，家目录，默认shell保存在&#x2F;etc&#x2F;passwd下，该文件每行的第二位（以冒号分隔）表示密码。但真正的密码其实被加密后放在&#x2F;etc&#x2F;shadow里，&#x2F;etc&#x2F;passwd里只显示为x。本文主要介绍shadow文件各字段含义和相关的密码生命周期配置。</p>\n<p>本文内使用的Linux环境是centos7.3, 操作时间是2017年10月12号</p>\n<p>&#x2F;etc&#x2F;shadow每行和&#x2F;etc&#x2F;passwd一一对应，命令<code>pwconv</code>根据&#x2F;etc&#x2F;passwd生成。每行由9个字段（以冒号分隔）组成，如下是每个字段的含义：</p>\n<h2 id=\"1-登录名-​\"><a href=\"#1-登录名-​\" class=\"headerlink\" title=\"1. 登录名: ​\"></a>1. 登录名: <a href=\"#_1-%E7%99%BB%E5%BD%95%E5%90%8D\">​</a></h2><p>如 root， 通过它，唯一匹配&#x2F;etc&#x2F;passwd中的一行</p>\n<h2 id=\"2-加密后的密码：-​\"><a href=\"#2-加密后的密码：-​\" class=\"headerlink\" title=\"2. 加密后的密码： ​\"></a>2. 加密后的密码： <a href=\"#_2-%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84%E5%AF%86%E7%A0%81\">​</a></h2><p>通常的格式为: $X$ZZZZZZ<br>X为数字，表示不同的加密算法，具体如下：</p>\n<table>\n<thead>\n<tr>\n<th>ID</th>\n<th>Method</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>MD5</td>\n</tr>\n<tr>\n<td>2a</td>\n<td>Blowfish</td>\n</tr>\n<tr>\n<td>5</td>\n<td>SHA-256</td>\n</tr>\n<tr>\n<td>6</td>\n<td>SHA-512</td>\n</tr>\n</tbody></table>\n<p>第二个星号后面的ZZZZ为加密后的密文, 具体是通过glibc里的crypt函数来实现加密。文章最后会提供一段程序，通过盐值来加密明文。可以通过<code>man 3 crypt</code>了解函数使用方法</p>\n<p>如果该字段 是 ! 或者 *， 表示该用户无法用密码登录系统.但可以通过其他方式登录。<br>如果该字段以感叹号!开头，其余是通常的格式，则系统认为密码被锁， ssh登录时即使输入正确的密码，也会拒绝登录. <code>usermod -L username</code> 就是使用该原理。<code>usermod -U username</code> 功能是解锁</p>\n<h2 id=\"3-密码最后修改时间：-​\"><a href=\"#3-密码最后修改时间：-​\" class=\"headerlink\" title=\"3. 密码最后修改时间： ​\"></a>3. 密码最后修改时间： <a href=\"#_3-%E5%AF%86%E7%A0%81%E6%9C%80%E5%90%8E%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4\">​</a></h2><p>通过<code>chage -d XX user</code>可以设置该字段<br>值为从1970 1月1号至改密码时的天数。<br>0表示用户需要在下次登录时修改密码<br>空值表示关闭密码有效期功能，即密码永远有效<br>如下是设置为0时的系统行为</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"variable\">@linux</span> /root]<span class=\"comment\"># grep test /etc/shadow</span></span><br><span class=\"line\"><span class=\"symbol\">test:</span><span class=\"variable\">$6</span><span class=\"variable\">$IFqUZWcW</span><span class=\"variable\">$lEDn9cLw</span><span class=\"symbol\">:</span><span class=\"number\">17450</span><span class=\"symbol\">:</span><span class=\"number\">0</span><span class=\"symbol\">:</span><span class=\"number\">99999</span><span class=\"symbol\">:</span><span class=\"number\">7</span>:::</span><br><span class=\"line\">[root<span class=\"variable\">@linux</span> /root]<span class=\"comment\"># chage -d 0 test</span></span><br><span class=\"line\">[root<span class=\"variable\">@linux</span> /root]<span class=\"comment\"># grep test /etc/shadow</span></span><br><span class=\"line\"><span class=\"symbol\">test:</span><span class=\"variable\">$6</span><span class=\"variable\">$IFqUZWcW</span><span class=\"variable\">$lEDn9cLw</span><span class=\"symbol\">:</span><span class=\"number\">0</span><span class=\"symbol\">:</span><span class=\"number\">0</span><span class=\"symbol\">:</span><span class=\"number\">99999</span><span class=\"symbol\">:</span><span class=\"number\">7</span>:::</span><br><span class=\"line\"><span class=\"variable\">$ </span>ssh test<span class=\"variable\">@XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span></span><br><span class=\"line\">test<span class=\"variable\">@XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span><span class=\"string\">&#x27;s password:</span></span><br><span class=\"line\"><span class=\"string\">You are required to change your password immediately (root enforced)</span></span><br><span class=\"line\"><span class=\"string\">Last login: Wed Oct 11 23:09:07 2017 from XX.XX.XX.XX</span></span><br><span class=\"line\"><span class=\"string\">WARNING: Your password has expired.</span></span><br><span class=\"line\"><span class=\"string\">You must change your password now and login again!</span></span><br><span class=\"line\"><span class=\"string\">Changing password for user test.</span></span><br><span class=\"line\"><span class=\"string\">Changing password for test.</span></span><br><span class=\"line\"><span class=\"string\">(current) UNIX password:</span></span><br><span class=\"line\"><span class=\"string\">New password:</span></span><br><span class=\"line\"><span class=\"string\">Retype new password:</span></span><br><span class=\"line\"><span class=\"string\">passwd: all authentication tokens updated successfully.</span></span><br><span class=\"line\"><span class=\"string\">Connection to XX.XX.XX.XX closed.</span></span><br><span class=\"line\"><span class=\"string\">$</span></span><br><span class=\"line\"><span class=\"string\">然后用新密码就可以登录了， 这个可以用于管理员强制普通用户修改密码</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-最小时间间隔：-​\"><a href=\"#4-最小时间间隔：-​\" class=\"headerlink\" title=\"4. 最小时间间隔： ​\"></a>4. 最小时间间隔： <a href=\"#_4-%E6%9C%80%E5%B0%8F%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94\">​</a></h2><p>通过<code>chage -m XXX user</code>可以设置该字段<br>两次修改口令之间所需的最小天数。<br>空或者0表示没有限制</p>\n<h2 id=\"5-最大时间间隔：-​\"><a href=\"#5-最大时间间隔：-​\" class=\"headerlink\" title=\"5. 最大时间间隔： ​\"></a>5. 最大时间间隔： <a href=\"#_5-%E6%9C%80%E5%A4%A7%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94\">​</a></h2><p>通过<code>chage -M XXX user</code>可以设置该字段<br>两次修改口令之间所需的最大天数。一旦超过，意味着密码过期.<br>空表示没有限制.</p>\n<p>如果该值小于最小时间间隔，则用户无法修改密码,如下演示其行为:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@linux /root]<span class=\"comment\"># grep test /etc/shadow</span></span><br><span class=\"line\"><span class=\"built_in\">test</span>:$6$xxFzM1X0<span class=\"variable\">$GzIbWsFIqhhcJ</span>:17450:5:4:7:::</span><br><span class=\"line\">[root@linux /root]<span class=\"comment\">#</span></span><br><span class=\"line\">[<span class=\"built_in\">test</span>@linux ~]$ passwd</span><br><span class=\"line\">Changing password <span class=\"keyword\">for</span> user <span class=\"built_in\">test</span>.</span><br><span class=\"line\">Changing password <span class=\"keyword\">for</span> <span class=\"built_in\">test</span>.</span><br><span class=\"line\">(current) UNIX password:</span><br><span class=\"line\">You must <span class=\"built_in\">wait</span> longer to change your password</span><br><span class=\"line\">passwd: Authentication token manipulation error</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-警告天数：-​\"><a href=\"#6-警告天数：-​\" class=\"headerlink\" title=\"6. 警告天数： ​\"></a>6. 警告天数： <a href=\"#_6-%E8%AD%A6%E5%91%8A%E5%A4%A9%E6%95%B0\">​</a></h2><p>通过<code>chage -W XXX user</code>可以设置该字段<br>在密码过期前（即 密码最后修改时间 + 最大时间间隔），提前多少天通知用户. 此时仍可以正常登陆，只是多了一行提示<br>空或者0表示无警告.<br>如下演示告警信息:</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"variable\">@linux</span> /root]<span class=\"comment\"># grep test /etc/shadow</span></span><br><span class=\"line\"><span class=\"symbol\">test:</span><span class=\"variable\">$6</span><span class=\"variable\">$xxFzM1X0</span><span class=\"variable\">$GzIbWsFIqhh</span><span class=\"symbol\">:</span><span class=\"number\">17450</span><span class=\"symbol\">:</span><span class=\"number\">0</span><span class=\"symbol\">:</span><span class=\"number\">6</span><span class=\"symbol\">:</span><span class=\"number\">7</span>:::</span><br><span class=\"line\">[root<span class=\"variable\">@linux</span> /root]<span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"variable\">$ </span>ssh test<span class=\"variable\">@XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span></span><br><span class=\"line\">test<span class=\"variable\">@XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span>.<span class=\"title class_\">XX</span><span class=\"string\">&#x27;s password:</span></span><br><span class=\"line\"><span class=\"string\">Warning: your password will expire in 6 days</span></span><br><span class=\"line\"><span class=\"string\">Last login: Wed Oct 11 23:36:04 2017 from XX.XX.XX.XX</span></span><br><span class=\"line\"><span class=\"string\">[test@linux ~]$</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"7-非活动周期-​\"><a href=\"#7-非活动周期-​\" class=\"headerlink\" title=\"7. 非活动周期: ​\"></a>7. 非活动周期: <a href=\"#_7-%E9%9D%9E%E6%B4%BB%E5%8A%A8%E5%91%A8%E6%9C%9F\">​</a></h2><p>通过<code>chage -I XXX user</code>可以设置该字段<br>表示密码过期后，多少天内用户仍可以正常登陆，但要求立即修改密码。 一旦超过该天数，系统会拒绝用户登陆<br>空值或者0表示没有非活动期，一旦密码过期直接拒绝登陆</p>\n<p>如下演示进入非活动期</p>\n<figure class=\"highlight nestedtext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">[root@linux /root]# chage -l test</span></span><br><span class=\"line\"><span class=\"attribute\">Last password change\t\t\t\t\t</span><span class=\"punctuation\">:</span> <span class=\"string\">Oct 01, 2017</span></span><br><span class=\"line\"><span class=\"attribute\">Password expires\t\t\t\t\t</span><span class=\"punctuation\">:</span> <span class=\"string\">Oct 02, 2017</span></span><br><span class=\"line\"><span class=\"attribute\">Password inactive\t\t\t\t\t</span><span class=\"punctuation\">:</span> <span class=\"string\">Nov 01, 2017</span></span><br><span class=\"line\"><span class=\"attribute\">Account expires\t\t\t\t\t\t</span><span class=\"punctuation\">:</span> <span class=\"string\">never</span></span><br><span class=\"line\"><span class=\"attribute\">Minimum number of days between password change\t\t</span><span class=\"punctuation\">:</span> <span class=\"string\">0</span></span><br><span class=\"line\"><span class=\"attribute\">Maximum number of days between password change\t\t</span><span class=\"punctuation\">:</span> <span class=\"string\">1</span></span><br><span class=\"line\"><span class=\"attribute\">Number of days of warning before password expires\t</span><span class=\"punctuation\">:</span> <span class=\"string\">7</span></span><br><span class=\"line\">[root@linux /root]# grep test /etc/shadow</span><br><span class=\"line\">test:$6$xxFzM1X0$GzIbWsFIqhhcJ:17440:0:1:7:30::</span><br><span class=\"line\"><span class=\"attribute\">$ ssh test@XX.XX.XX.XX</span></span><br><span class=\"line\"><span class=\"attribute\">test@XX.XX.XX.XX&#x27;s password</span><span class=\"punctuation\">:</span></span><br><span class=\"line\"><span class=\"attribute\">You are required to change your password immediately (password aged)</span></span><br><span class=\"line\"><span class=\"attribute\">Last login</span><span class=\"punctuation\">:</span> <span class=\"string\">Wed Oct 11 23:51:05 2017 from XX.XX.XX.XX</span></span><br><span class=\"line\"><span class=\"attribute\">WARNING</span><span class=\"punctuation\">:</span> <span class=\"string\">Your password has expired.</span></span><br><span class=\"line\"><span class=\"attribute\">You must change your password now and login again!</span></span><br><span class=\"line\"><span class=\"attribute\">Changing password for user test.</span></span><br><span class=\"line\"><span class=\"attribute\">Changing password for test.</span></span><br><span class=\"line\"><span class=\"attribute\">(current) UNIX password</span><span class=\"punctuation\">:</span></span><br><span class=\"line\"><span class=\"attribute\">New password</span><span class=\"punctuation\">:</span></span><br><span class=\"line\"><span class=\"attribute\">Retype new password</span><span class=\"punctuation\">:</span></span><br><span class=\"line\"><span class=\"attribute\">passwd</span><span class=\"punctuation\">:</span> <span class=\"string\">all authentication tokens updated successfully.</span></span><br><span class=\"line\">Connection to XX.XX.XX.XX closed.</span><br></pre></td></tr></table></figure>\n\n<p>如下演示超过非活动期:</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@linux</span> /root]<span class=\"meta\"># chage -l test</span></span><br><span class=\"line\">Last password change\t\t\t\t\t: Oct <span class=\"number\">01</span>, <span class=\"number\">2017</span></span><br><span class=\"line\">Password expires\t\t\t\t\t: Oct <span class=\"number\">02</span>, <span class=\"number\">2017</span></span><br><span class=\"line\">Password inactive\t\t\t\t\t: Oct <span class=\"number\">02</span>, <span class=\"number\">2017</span></span><br><span class=\"line\">Account expires\t\t\t\t\t\t: never</span><br><span class=\"line\">Minimum <span class=\"built_in\">number</span> of days between password change\t\t: <span class=\"number\">0</span></span><br><span class=\"line\">Maximum <span class=\"built_in\">number</span> of days between password change\t\t: <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"built_in\">Number</span> of days of warning before password expires\t: <span class=\"number\">7</span></span><br><span class=\"line\">[root<span class=\"symbol\">@linux</span> /root]<span class=\"meta\"># grep test /etc/shadow</span></span><br><span class=\"line\">test:$6$wODB1.oE$39TBytc<span class=\"number\">.5</span>y0OkKn:<span class=\"number\">17440</span>:<span class=\"number\">0</span>:<span class=\"number\">1</span>:<span class=\"number\">7</span>:<span class=\"number\">0</span>::</span><br><span class=\"line\">$ ssh test<span class=\"symbol\">@10</span><span class=\"number\">.211</span><span class=\"number\">.55</span><span class=\"number\">.9</span></span><br><span class=\"line\">test<span class=\"symbol\">@10</span><span class=\"number\">.211</span><span class=\"number\">.55</span><span class=\"number\">.9</span><span class=\"string\">&#x27;s password:</span></span><br><span class=\"line\"><span class=\"string\">Your account has expired; please contact your system administrator</span></span><br><span class=\"line\"><span class=\"string\">Connection closed by 10.211.55.9</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"8-用户过期时间：-​\"><a href=\"#8-用户过期时间：-​\" class=\"headerlink\" title=\"8. 用户过期时间： ​\"></a>8. 用户过期时间： <a href=\"#_8-%E7%94%A8%E6%88%B7%E8%BF%87%E6%9C%9F%E6%97%B6%E9%97%B4\">​</a></h2><p>通过<code>chage -E XXX user</code>可以设置该字段<br>用户过期时间，值表示为自19701月1号起的天数.<br>密码过期后，用户只是无法使用密码登陆，还可以用其他方式。 一旦用户过期，任何方式都无法用该用户登陆<br>空值表示永远不会过期<br>0值不建议使用。解释取决于程序本身</p>\n<h2 id=\"9-其他为保留字段，为将来扩展功能用-​\"><a href=\"#9-其他为保留字段，为将来扩展功能用-​\" class=\"headerlink\" title=\"9. 其他为保留字段，为将来扩展功能用 ​\"></a>9. 其他为保留字段，为将来扩展功能用 <a href=\"#_9-%E5%85%B6%E4%BB%96%E4%B8%BA%E4%BF%9D%E7%95%99%E5%AD%97%E6%AE%B5-%E4%B8%BA%E5%B0%86%E6%9D%A5%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD%E7%94%A8\">​</a></h2><h2 id=\"自己写代码实现加密-C-和-Python实现-​\"><a href=\"#自己写代码实现加密-C-和-Python实现-​\" class=\"headerlink\" title=\"自己写代码实现加密(C 和 Python实现) ​\"></a>自己写代码实现加密(C 和 Python实现) <a href=\"#%E8%87%AA%E5%B7%B1%E5%86%99%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%8A%A0%E5%AF%86-c-%E5%92%8C-python%E5%AE%9E%E7%8E%B0\">​</a></h2><p>c</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;crypt.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"type\">int</span> argc, <span class=\"type\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"> <span class=\"keyword\">if</span>(argc!=<span class=\"number\">3</span>)</span><br><span class=\"line\"> <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\"> <span class=\"type\">char</span> *buf = <span class=\"built_in\">crypt</span>((<span class=\"type\">const</span> <span class=\"type\">char</span> *)argv[<span class=\"number\">1</span>], (<span class=\"type\">const</span> <span class=\"type\">char</span> *)argv[<span class=\"number\">2</span>]);</span><br><span class=\"line\"> <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;salt: %s, crypt: %s\\n&quot;</span>, argv[<span class=\"number\">2</span>], buf);</span><br><span class=\"line\"> <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#gcc</span> -g <span class=\"selector-tag\">a</span><span class=\"selector-class\">.c</span> -lcrypt </span><br><span class=\"line\"><span class=\"selector-id\">#grep</span> root /etc/shadow </span><br><span class=\"line\">root:$<span class=\"number\">6</span><span class=\"variable\">$DEgVEU0T</span><span class=\"variable\">$mwlTGb</span>/nTtvpIJcoIy2t9xNMgv0<span class=\"selector-class\">.IT34WLvQ7VmbWJP9rU8Ysp9JyJ8I8PxEleGPWoirdbk4VKbhtCg6P</span><span class=\"selector-class\">.sm1</span>.:<span class=\"number\">17450</span>:<span class=\"number\">0</span>:<span class=\"number\">99999</span>:<span class=\"number\">7</span>::: </span><br><span class=\"line\">#./<span class=\"selector-tag\">a</span><span class=\"selector-class\">.out</span> abc \\$<span class=\"number\">6</span>\\<span class=\"variable\">$DEgVEU0T</span> </span><br><span class=\"line\">salt: $<span class=\"number\">6</span><span class=\"variable\">$DEgVEU0T</span>, crypt: $<span class=\"number\">6</span><span class=\"variable\">$DEgVEU0T</span><span class=\"variable\">$mwlTGb</span>/nTtvpIJcoIy2t9xNMgv0<span class=\"selector-class\">.IT34WLvQ7VmbWJP9rU8Ysp9JyJ8I8PxEleGPWoirdbk4VKbhtCg6P</span><span class=\"selector-class\">.sm1</span>.</span><br></pre></td></tr></table></figure>\n\n<p>Python 2.7 自带crypt模块，它是C库 crypt的binding， 实现更简单。代码如下：</p>\n<figure class=\"highlight dart\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"meta\">@abc</span> ~]# python</span><br><span class=\"line\">Python <span class=\"number\">2.7</span><span class=\"number\">.5</span> (<span class=\"keyword\">default</span>, Nov  <span class=\"number\">6</span> <span class=\"number\">2016</span>, <span class=\"number\">00</span>:<span class=\"number\">28</span>:<span class=\"number\">07</span>)</span><br><span class=\"line\">[GCC <span class=\"number\">4.8</span><span class=\"number\">.5</span> <span class=\"number\">20150623</span> (Red Hat <span class=\"number\">4.8</span><span class=\"number\">.5</span><span class=\"number\">-11</span>)] <span class=\"keyword\">on</span> linux2</span><br><span class=\"line\"><span class=\"built_in\">Type</span> <span class=\"string\">&quot;help&quot;</span>, <span class=\"string\">&quot;copyright&quot;</span>, <span class=\"string\">&quot;credits&quot;</span> or <span class=\"string\">&quot;license&quot;</span> <span class=\"keyword\">for</span> more information.</span><br><span class=\"line\">&gt;&gt;&gt; <span class=\"keyword\">import</span> crypt</span><br><span class=\"line\">&gt;&gt;&gt; crypt.crypt(<span class=\"string\">&quot;abc&quot;</span>, <span class=\"string\">&quot;<span class=\"subst\">$6</span><span class=\"subst\">$DEgVEU0T</span>&quot;</span>)</span><br><span class=\"line\"><span class=\"string\">&#x27;<span class=\"subst\">$6</span><span class=\"subst\">$DEgVEU0T</span><span class=\"subst\">$mwlTGb</span>/nTtvpIJcoIy2t9xNMgv0.IT34WLvQ7VmbWJP9rU8Ysp9JyJ8I8PxEleGPWoirdbk4VKbhtCg6P.sm1.&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"密码相关一些配置-​\"><a href=\"#密码相关一些配置-​\" class=\"headerlink\" title=\"密码相关一些配置 ​\"></a>密码相关一些配置 <a href=\"#%E5%AF%86%E7%A0%81%E7%9B%B8%E5%85%B3%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE\">​</a></h2><p>&#x2F;etc&#x2F;login.defs 用来存放一些与创建用户和密码相关的配置信息<br>当使用useradd创建新用户时，系统会读取该文件，然后写入&#x2F;etc&#x2F;shadows.<br>和密码相关的只要是 PASS_MAX_DAYS，PASS_MIN_DAYS，PASS_MIN_LEN，PASS_WARN_AGE，ENCRYPT_METHOD 这几个参数<br>UMASK用来定义默认的新建文件权限</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@linux /root]<span class=\"comment\"># grep ^[^#] /etc/login.defs</span></span><br><span class=\"line\">MAIL_DIR\t/var/spool/mail</span><br><span class=\"line\">PASS_MAX_DAYS\t99999</span><br><span class=\"line\">PASS_MIN_DAYS\t0</span><br><span class=\"line\">PASS_MIN_LEN\t5</span><br><span class=\"line\">PASS_WARN_AGE\t7</span><br><span class=\"line\">UID_MIN                  1000</span><br><span class=\"line\">UID_MAX                 60000</span><br><span class=\"line\">SYS_UID_MIN               201</span><br><span class=\"line\">SYS_UID_MAX               999</span><br><span class=\"line\">GID_MIN                  1000</span><br><span class=\"line\">GID_MAX                 60000</span><br><span class=\"line\">SYS_GID_MIN               201</span><br><span class=\"line\">SYS_GID_MAX               999</span><br><span class=\"line\">CREATE_HOME\t<span class=\"built_in\">yes</span></span><br><span class=\"line\">UMASK           077</span><br><span class=\"line\">USERGROUPS_ENAB <span class=\"built_in\">yes</span></span><br><span class=\"line\">ENCRYPT_METHOD SHA512</span><br></pre></td></tr></table></figure>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>参考：<br>man 8 pwconv<br>man 5 shadow<br>man 3 crypt</p></blockquote>\n","text":"Linux /etc/shadow 文件学习笔记Linux系统下，创建的用户信息如ID，家目录，默认shell保存在/etc/passwd下，该文件每行的第二位...","permalink":"/post/LINUX/Linux etc shadow 文件学习笔记","photos":[],"count_time":{"symbolsCount":"6.1k","symbolsTime":"6 mins."},"categories":[{"name":"etc","slug":"etc","count":2,"path":"api/categories/etc.json"},{"name":"LINUX","slug":"etc/LINUX","count":2,"path":"api/categories/etc/LINUX.json"}],"tags":[{"name":"通过","slug":"通过","count":2,"path":"api/tags/通过.json"},{"name":"chage","slug":"chage","count":1,"path":"api/tags/chage.json"},{"name":"user","slug":"user","count":1,"path":"api/tags/user.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Linux-x2F-etc-x2F-shadow-%E6%96%87%E4%BB%B6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\"><span class=\"toc-text\">Linux &#x2F;etc&#x2F;shadow 文件学习笔记</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E7%99%BB%E5%BD%95%E5%90%8D-%E2%80%8B\"><span class=\"toc-text\">1. 登录名: </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84%E5%AF%86%E7%A0%81%EF%BC%9A-%E2%80%8B\"><span class=\"toc-text\">2. 加密后的密码： </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E5%AF%86%E7%A0%81%E6%9C%80%E5%90%8E%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4%EF%BC%9A-%E2%80%8B\"><span class=\"toc-text\">3. 密码最后修改时间： </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-%E6%9C%80%E5%B0%8F%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94%EF%BC%9A-%E2%80%8B\"><span class=\"toc-text\">4. 最小时间间隔： </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#5-%E6%9C%80%E5%A4%A7%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94%EF%BC%9A-%E2%80%8B\"><span class=\"toc-text\">5. 最大时间间隔： </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#6-%E8%AD%A6%E5%91%8A%E5%A4%A9%E6%95%B0%EF%BC%9A-%E2%80%8B\"><span class=\"toc-text\">6. 警告天数： </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#7-%E9%9D%9E%E6%B4%BB%E5%8A%A8%E5%91%A8%E6%9C%9F-%E2%80%8B\"><span class=\"toc-text\">7. 非活动周期: </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#8-%E7%94%A8%E6%88%B7%E8%BF%87%E6%9C%9F%E6%97%B6%E9%97%B4%EF%BC%9A-%E2%80%8B\"><span class=\"toc-text\">8. 用户过期时间： </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#9-%E5%85%B6%E4%BB%96%E4%B8%BA%E4%BF%9D%E7%95%99%E5%AD%97%E6%AE%B5%EF%BC%8C%E4%B8%BA%E5%B0%86%E6%9D%A5%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD%E7%94%A8-%E2%80%8B\"><span class=\"toc-text\">9. 其他为保留字段，为将来扩展功能用 </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%87%AA%E5%B7%B1%E5%86%99%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%E5%8A%A0%E5%AF%86-C-%E5%92%8C-Python%E5%AE%9E%E7%8E%B0-%E2%80%8B\"><span class=\"toc-text\">自己写代码实现加密(C 和 Python实现) </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AF%86%E7%A0%81%E7%9B%B8%E5%85%B3%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE-%E2%80%8B\"><span class=\"toc-text\">密码相关一些配置 </span></a></li></ol></li></ol>","author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"常见的bpftrace脚本","uid":"deb7ca296fb4175b782a15a32d428fc0","slug":"LINUX/常见的bpftrace脚本","date":"2025-08-05T17:34:11.000Z","updated":"2025-12-05T01:47:18.258Z","comments":true,"path":"api/articles/LINUX/常见的bpftrace脚本.json","keywords":"XuGuangSheng","cover":"/covers/bpftrace.jpg","text":"常见的bpftrace脚本跟踪 tracepoint kfree_skb ​123456789101112131415161718192021222324252...","permalink":"/post/LINUX/常见的bpftrace脚本","photos":[],"count_time":{"symbolsCount":"4.1k","symbolsTime":"4 mins."},"categories":[{"name":"跟踪","slug":"跟踪","count":1,"path":"api/categories/跟踪.json"},{"name":"LINUX","slug":"跟踪/LINUX","count":1,"path":"api/categories/跟踪/LINUX.json"}],"tags":[{"name":"tracepoint","slug":"tracepoint","count":1,"path":"api/tags/tracepoint.json"},{"name":"kfree","slug":"kfree","count":1,"path":"api/tags/kfree.json"},{"name":"skb","slug":"skb","count":1,"path":"api/tags/skb.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Linux 下常用命令与技巧汇总","uid":"dbdd74b0108262782d34164391ad385e","slug":"LINUX/Linux 下常用命令与技巧汇总","date":"2025-08-05T17:32:52.000Z","updated":"2025-12-05T01:47:01.455Z","comments":true,"path":"api/articles/LINUX/Linux 下常用命令与技巧汇总.json","keywords":"XuGuangSheng","cover":"/covers/linux.jpg","text":"Linux 下常用命令与技巧汇总收集自己常用到的linux命令与技巧,方便后续查找.不定期更新. 1. 查询系统准确的启动时间 ​bash 12date -d ...","permalink":"/post/LINUX/Linux 下常用命令与技巧汇总","photos":[],"count_time":{"symbolsCount":"58k","symbolsTime":"52 mins."},"categories":[{"name":"bash","slug":"bash","count":2,"path":"api/categories/bash.json"},{"name":"LINUX","slug":"bash/LINUX","count":2,"path":"api/categories/bash/LINUX.json"}],"tags":[{"name":"https","slug":"https","count":44,"path":"api/tags/https.json"},{"name":"com","slug":"com","count":26,"path":"api/tags/com.json"},{"name":"redhat","slug":"redhat","count":1,"path":"api/tags/redhat.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}