{"title":"小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV","uid":"902bce5943bfcf4419fe702bc9520551","slug":"OTHER/小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV","date":"2023-07-26T23:55:11.000Z","updated":"2025-12-05T01:48:04.060Z","comments":true,"path":"api/articles/OTHER/小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV.json","keywords":"XuGuangSheng","cover":"/covers/ax9000ssh-iptviptv.jpg","content":"<h1 id=\"小米AX9000（SSH后）-开启北京联通IPTV转发服务，全家设备可以看IPTV\"><a href=\"#小米AX9000（SSH后）-开启北京联通IPTV转发服务，全家设备可以看IPTV\" class=\"headerlink\" title=\"小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV\"></a>小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV</h1><p>北京联通，宽带+IPTV已经入户，<br>我需求不用联通送的IPTV盒子，在一根网线（光猫Lan1口）、路由器相同WIFI下（上网、IPTV信号），<br>全家手机、电视盒子播放北京联通IPTV节目。<br><strong>设置的前提</strong><br> IPTV是DHCP协议，光猫有VLAN设置，光猫已经设好组播IGMP proxy，所以用光猫LAN1口，上网和同时看联通IPTV信号  </p>\n<p>AX9000的设置  </p>\n<ol>\n<li>获得AX9000的SSH<br>看之前通过开发板docker获取ssh的文章</li>\n<li>登录SSH，安装udpxy</li>\n</ol>\n<ul>\n<li>自动安装  <figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update  </span><br><span class=\"line\">opkg <span class=\"keyword\">install</span> udpxy</span><br></pre></td></tr></table></figure></li>\n<li>手动安装<br>如果上面opkg intsall udpxy失败，手动下载安装<br>登录小米路由器SSH</li>\n</ul>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">cd</span> /tmp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">wget</span> https://downloads.openwrt.org/snapshots/packages/aarch64\\_cortex-a53/packages/udpxy\\_1.<span class=\"number\">0</span>-<span class=\"number\">25</span>.<span class=\"number\">1</span>-<span class=\"number\">1</span>\\_aarch64\\_cortex-a53.ipk</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">opkg</span> install udpxy\\_1.<span class=\"number\">0</span>-<span class=\"number\">25</span>.<span class=\"number\">1</span>-<span class=\"number\">1</span>\\_aarch64_cortex-a53.ipk</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>改动配置文件  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /etc/config  </span><br></pre></td></tr></table></figure></li>\n<li>备份三个配置文件  <figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">cp</span> udpxy udpxy.backup  </span><br><span class=\"line\"><span class=\"keyword\">cp</span> network network.backup  </span><br><span class=\"line\"><span class=\"keyword\">cp</span> firewall firewall.backup</span><br></pre></td></tr></table></figure></li>\n<li>编辑 udpxy 配置文件  <figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/config/udpxy  </span><br></pre></td></tr></table></figure>\n&#x3D;&#x3D;&#x3D; 配置文件内容 udpxy 端口4022 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;  <figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config udpxy                                                                                   </span><br><span class=\"line\">        #<span class=\"keyword\">option</span> disabled <span class=\"string\">&#x27;1&#x27;</span>                                                                   </span><br><span class=\"line\">        <span class=\"keyword\">option</span> respawn <span class=\"string\">&#x27;1&#x27;</span>                                                                    </span><br><span class=\"line\">        <span class=\"keyword\">option</span> <span class=\"keyword\">verbose</span> <span class=\"string\">&#x27;0&#x27;</span>                                                                    </span><br><span class=\"line\">        <span class=\"keyword\">option</span> status <span class=\"string\">&#x27;1&#x27;</span>                                                                      </span><br><span class=\"line\">        # <span class=\"keyword\">option</span> bind <span class=\"string\">&#x27;0.0.0.0&#x27;</span>                                                                </span><br><span class=\"line\">        <span class=\"keyword\">option</span> port <span class=\"string\">&#x27;4022&#x27;</span>                                                                    </span><br><span class=\"line\">        <span class=\"keyword\">option</span> source <span class=\"string\">&#x27;eth4&#x27;</span>                                                                   </span><br><span class=\"line\">        <span class=\"keyword\">option</span> disabled <span class=\"string\">&#x27;0&#x27;</span>  </span><br></pre></td></tr></table></figure></li>\n<li>保存后，回到ssh 命令行，启动udpxy<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service udpxy restart  <span class=\"built_in\"></span></span><br><span class=\"line\"><span class=\"built_in\">service </span>udpxy <span class=\"built_in\">enable</span>  </span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>PC web检测udpxy服务状态：<br>http:&#x2F;&#x2F;路由器-ip:4022&#x2F;status</p>\n<p>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</p>\n<ol start=\"7\">\n<li>编辑 network 网络配置文件  <figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/config/network</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>&#x3D;&#x3D;&#x3D; 配置文件内容 wan 是机器配置，‘iptv’网络接口也同样设置在WAN上 eth4， 增加的</p>\n<p>option metric 10（wan口上网）,20（IPTV） 设置跃点&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;  </p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config <span class=\"keyword\">interface</span> &#x27;<span class=\"symbol\">wan</span>&#x27;                                                                         </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">proto</span> &#x27;<span class=\"symbol\">pppoe</span>&#x27;                                                                   </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">special</span> &#x27;<span class=\"symbol\">0</span>&#x27;                                                                    </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">username</span> &#x27;宽带账户&#x27;                                                        </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">mru</span> &#x27;<span class=\"symbol\">1480</span>&#x27;                                                                      </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">password</span> &#x27;宽带密码&#x27;                                                              </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">ifname</span> &#x27;<span class=\"symbol\">eth4</span>&#x27;  </span><br><span class=\"line\"> # 以下为新增数据    </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">metric</span> &#x27;<span class=\"symbol\">10</span>&#x27; </span><br><span class=\"line\">        </span><br><span class=\"line\"> <span class=\"symbol\">config</span> <span class=\"symbol\">interface</span> &#x27;<span class=\"symbol\">iptv</span>&#x27;                                                                       </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">ifname</span> &#x27;<span class=\"symbol\">eth4</span>&#x27;                                                                  </span><br><span class=\"line\">        <span class=\"symbol\">option</span> \\<span class=\"symbol\">_orig</span>\\<span class=\"symbol\">_ifname</span> &#x27;<span class=\"symbol\">eth4</span>&#x27;                                                             </span><br><span class=\"line\">        <span class=\"symbol\">option</span> \\<span class=\"symbol\">_orig</span>\\<span class=\"symbol\">_bridge</span> &#x27;<span class=\"symbol\">false</span>&#x27;                                                           </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">proto</span> &#x27;<span class=\"symbol\">dhcp</span>&#x27;                                                                    </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">delegate</span> &#x27;<span class=\"symbol\">0</span>&#x27;                                                                    </span><br><span class=\"line\">        <span class=\"symbol\">option</span> <span class=\"symbol\">metric</span> &#x27;<span class=\"symbol\">20</span>&#x27;   </span><br></pre></td></tr></table></figure>\n<ol start=\"8\">\n<li>编辑firewall防火墙配置<figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/config/firewall</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">config <span class=\"type\">zone</span>                                                                                                  </span><br><span class=\"line\">        <span class=\"keyword\">option</span> <span class=\"type\">name</span> <span class=\"string\">&#x27;wan&#x27;</span>                                                                                   </span><br><span class=\"line\">        <span class=\"keyword\">option</span> <span class=\"keyword\">input</span> <span class=\"string\">&#x27;REJECT&#x27;</span>                                                                                </span><br><span class=\"line\">        <span class=\"keyword\">option</span> output <span class=\"string\">&#x27;ACCEPT&#x27;</span>                                                                               </span><br><span class=\"line\">        <span class=\"keyword\">option</span> forward <span class=\"string\">&#x27;REJECT&#x27;</span>                                                                             </span><br><span class=\"line\">        <span class=\"keyword\">option</span> masq <span class=\"string\">&#x27;1&#x27;</span>                                                                                      </span><br><span class=\"line\">        <span class=\"keyword\">option</span> mtu_fix <span class=\"string\">&#x27;1&#x27;</span>                                                                                 </span><br><span class=\"line\"> # 以下为新增数据</span><br><span class=\"line\">        <span class=\"keyword\">option</span> network <span class=\"string\">&#x27;wan wan6 iptv&#x27;</span>  </span><br><span class=\"line\">  </span><br><span class=\"line\">config <span class=\"keyword\">rule</span>                                                                                   </span><br><span class=\"line\">        <span class=\"keyword\">option</span> src <span class=\"string\">&#x27;wan&#x27;</span>        </span><br><span class=\"line\">        <span class=\"keyword\">option</span> proto <span class=\"string\">&#x27;udp&#x27;</span>                                                                    </span><br><span class=\"line\">        <span class=\"keyword\">option</span> dest_ip <span class=\"string\">&#x27;224.0.0.0/4&#x27;</span>                                                           </span><br><span class=\"line\">        <span class=\"keyword\">option</span> target <span class=\"string\">&#x27;ACCEPT&#x27;</span>                                                                 </span><br><span class=\"line\">        <span class=\"keyword\">option</span> <span class=\"type\">name</span> <span class=\"string\">&#x27;Allow-UDP-udpxy&#x27;</span>  </span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>配置完重启，路由器。大功告成<br><a href=\"https://github.com/dandeliono/bj-unicom-iptv\">北京联通iptv列表</a></p>\n","text":"小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV北京联通，宽带+IPTV已经入户，我需求不用联通送的IPTV盒子，在一根网线（...","permalink":"/post/OTHER/小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV","photos":[],"count_time":{"symbolsCount":"5.1k","symbolsTime":"5 mins."},"categories":[{"name":"IPTV","slug":"IPTV","count":1,"path":"api/categories/IPTV.json"},{"name":"OTHER","slug":"IPTV/OTHER","count":1,"path":"api/categories/IPTV/OTHER.json"}],"tags":[{"name":"udpxy","slug":"udpxy","count":1,"path":"api/tags/udpxy.json"},{"name":"SSH","slug":"SSH","count":1,"path":"api/tags/SSH.json"},{"name":"编辑","slug":"编辑","count":1,"path":"api/tags/编辑.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%B0%8F%E7%B1%B3AX9000%EF%BC%88SSH%E5%90%8E%EF%BC%89-%E5%BC%80%E5%90%AF%E5%8C%97%E4%BA%AC%E8%81%94%E9%80%9AIPTV%E8%BD%AC%E5%8F%91%E6%9C%8D%E5%8A%A1%EF%BC%8C%E5%85%A8%E5%AE%B6%E8%AE%BE%E5%A4%87%E5%8F%AF%E4%BB%A5%E7%9C%8BIPTV\"><span class=\"toc-text\">小米AX9000（SSH后） 开启北京联通IPTV转发服务，全家设备可以看IPTV</span></a></li></ol>","author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Producer Metadata 读取与更新机制","uid":"4cc462e9c8fcfd4947ede10d296d33aa","slug":"MIDDLEWARE/Producer Metadata 读取与更新机制","date":"2023-08-11T14:30:38.000Z","updated":"2025-12-05T01:47:36.647Z","comments":true,"path":"api/articles/MIDDLEWARE/Producer Metadata 读取与更新机制.json","keywords":"XuGuangSheng","cover":"/covers/producer-metadata.jpg","text":"Producer Metadata 读取与更新机制一、前言宏观上介绍了 Producer 的宏观模型，其中通过 waitOnMetadata() 方法获取 to...","permalink":"/post/MIDDLEWARE/Producer Metadata 读取与更新机制","photos":[],"count_time":{"symbolsCount":"5.8k","symbolsTime":"5 mins."},"categories":[{"name":"Metadata","slug":"Metadata","count":1,"path":"api/categories/Metadata.json"},{"name":"MIDDLEWARE","slug":"Metadata/MIDDLEWARE","count":1,"path":"api/categories/Metadata/MIDDLEWARE.json"}],"tags":[{"name":"partition","slug":"partition","count":2,"path":"api/tags/partition.json"},{"name":"metadata","slug":"metadata","count":1,"path":"api/tags/metadata.json"},{"name":"NetworkClient","slug":"NetworkClient","count":1,"path":"api/tags/NetworkClient.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"一文讲解Elasticsearch java restful api 跨版本兼容解决方案","uid":"a49fcb0de63d67d2f42e8c106ec83312","slug":"JAVA/一文讲解Elasticsearch java restful api 跨版本兼容解决方案","date":"2023-07-24T16:14:49.000Z","updated":"2025-12-05T01:46:43.536Z","comments":true,"path":"api/articles/JAVA/一文讲解Elasticsearch java restful api 跨版本兼容解决方案.json","keywords":"XuGuangSheng","cover":"/covers/elasticsearch-java-restful-api.jpg","text":"一文讲解Elasticsearch java restful api 跨版本兼容解决方案之前的文章elasticsearch&kibana从6.0升级到7.9完...","permalink":"/post/JAVA/一文讲解Elasticsearch java restful api 跨版本兼容解决方案","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"client","slug":"client","count":1,"path":"api/categories/client.json"},{"name":"JAVA","slug":"client/JAVA","count":1,"path":"api/categories/client/JAVA.json"}],"tags":[{"name":"search","slug":"search","count":2,"path":"api/tags/search.json"},{"name":"api","slug":"api","count":1,"path":"api/tags/api.json"},{"name":"high","slug":"high","count":1,"path":"api/tags/high.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}