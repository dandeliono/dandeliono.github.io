{"title":"k8s部署springboot的demo项目","uid":"9a9dc15a004def10ae461436e34e9bad","slug":"OCI/k8s部署springboot的demo项目","date":"2023-01-28T02:17:09.000Z","updated":"2025-09-30T03:26:57.947Z","comments":true,"path":"api/articles/OCI/k8s部署springboot的demo项目.json","keywords":"XuGuangSheng","cover":"/covers/k8sspringbootdemo.jpg","content":"<h1 id=\"k8s部署springboot的demo项目\"><a href=\"#k8s部署springboot的demo项目\" class=\"headerlink\" title=\"k8s部署springboot的demo项目\"></a>k8s部署springboot的demo项目</h1><h2 id=\"1-准备jar包\"><a href=\"#1-准备jar包\" class=\"headerlink\" title=\"1 准备jar包\"></a>1 准备jar包</h2><p>1.1 把你的springboot项目打包成可执行jar包</p>\n<p>1.2 把jar包上传到Linux服务器</p>\n<h2 id=\"2-构建docker镜像\"><a href=\"#2-构建docker镜像\" class=\"headerlink\" title=\"2 构建docker镜像\"></a>2 构建<a href=\"https://so.csdn.net/so/search?q=docker&spm=1001.2101.3001.7020\">docker</a>镜像</h2><h4 id=\"2-1-编写Dockerfile\"><a href=\"#2-1-编写Dockerfile\" class=\"headerlink\" title=\"2.1 编写Dockerfile\"></a>2.1 编写Dockerfile</h4><figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">vim Dockerfile</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>内容</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">FROM</span> java:<span class=\"number\">8</span></span><br><span class=\"line\"><span class=\"keyword\">MAINTAINER</span> luozhanfeng</span><br><span class=\"line\"><span class=\"keyword\">ADD</span><span class=\"language-bash\"> demo.jar /demo.jar</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">80</span></span><br><span class=\"line\"><span class=\"keyword\">ENTRYPOINT</span><span class=\"language-bash\"> [<span class=\"string\">&quot;java&quot;</span>,<span class=\"string\">&quot;-jar&quot;</span>,<span class=\"string\">&quot;/demo.jar&quot;</span>]</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-2-开始构建\"><a href=\"#2-2-开始构建\" class=\"headerlink\" title=\"2.2 开始构建\"></a>2.2 开始构建</h4><figure class=\"highlight armasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">docker</span> build -t luozhanfeng/demo:<span class=\"built_in\">v1</span> .</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/df4a41e62e235862decb89280c7b2b56.png\"></p>\n<h4 id=\"2-2-查看镜像\"><a href=\"#2-2-查看镜像\" class=\"headerlink\" title=\"2.2 查看镜像\"></a>2.2 查看镜像</h4><figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">docker images</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/9d6ab2bc6f2443ec40497ed81b128f56.png\"></p>\n<h2 id=\"3-部署-k8s\"><a href=\"#3-部署-k8s\" class=\"headerlink\" title=\"3 部署 k8s\"></a>3 部署 k8s</h2><h4 id=\"3-1-编写deployment和service的yaml\"><a href=\"#3-1-编写deployment和service的yaml\" class=\"headerlink\" title=\"3.1 编写deployment和service的yaml\"></a>3.1 编写deployment和service的<a href=\"https://so.csdn.net/so/search?q=yaml&spm=1001.2101.3001.7020\">yaml</a></h4><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Service</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">demo</span></span><br><span class=\"line\">  <span class=\"attr\">namespace:</span> <span class=\"string\">default</span></span><br><span class=\"line\">  <span class=\"attr\">labels:</span></span><br><span class=\"line\">    <span class=\"attr\">app:</span> <span class=\"string\">demo</span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">NodePort</span> <span class=\"comment\">#对外访问的类型</span></span><br><span class=\"line\">  <span class=\"attr\">ports:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"attr\">port:</span> <span class=\"number\">8030</span></span><br><span class=\"line\">      <span class=\"attr\">nodePort:</span> <span class=\"number\">30090</span> <span class=\"comment\">#service对外开放端口</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span></span><br><span class=\"line\">    <span class=\"attr\">app:</span> <span class=\"string\">demo</span></span><br><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"attr\">apiVersion:</span> <span class=\"string\">apps/v1</span></span><br><span class=\"line\"><span class=\"attr\">kind:</span> <span class=\"string\">Deployment</span> <span class=\"comment\">#对象类型</span></span><br><span class=\"line\"><span class=\"attr\">metadata:</span></span><br><span class=\"line\">  <span class=\"attr\">name:</span> <span class=\"string\">demo</span> <span class=\"comment\">#名称</span></span><br><span class=\"line\">  <span class=\"attr\">labels:</span></span><br><span class=\"line\">    <span class=\"attr\">app:</span> <span class=\"string\">demo</span> <span class=\"comment\">#标注 </span></span><br><span class=\"line\"><span class=\"attr\">spec:</span></span><br><span class=\"line\">  <span class=\"attr\">replicas:</span> <span class=\"number\">3</span> <span class=\"comment\">#运行容器的副本数，修改这里可以快速修改分布式节点数量</span></span><br><span class=\"line\">  <span class=\"attr\">selector:</span></span><br><span class=\"line\">    <span class=\"attr\">matchLabels:</span></span><br><span class=\"line\">      <span class=\"attr\">app:</span> <span class=\"string\">demo</span></span><br><span class=\"line\">  <span class=\"attr\">template:</span></span><br><span class=\"line\">    <span class=\"attr\">metadata:</span></span><br><span class=\"line\">      <span class=\"attr\">labels:</span></span><br><span class=\"line\">        <span class=\"attr\">app:</span> <span class=\"string\">demo</span></span><br><span class=\"line\">    <span class=\"attr\">spec:</span></span><br><span class=\"line\">      <span class=\"attr\">containers:</span> <span class=\"comment\">#docker容器的配置</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">demo</span></span><br><span class=\"line\">          <span class=\"attr\">image:</span> <span class=\"string\">luozhanfeng/demo:v1</span> <span class=\"comment\">#本地镜像</span></span><br><span class=\"line\">          <span class=\"comment\">#image: harbor.saas.xxx-ift.com/luozhanfeng/demo:v1 #远程仓库</span></span><br><span class=\"line\">          <span class=\"attr\">imagePullPolicy:</span> <span class=\"string\">IfNotPresent</span> <span class=\"comment\"># Always：总是拉取； IfNotPresent：默认值,本地有则使用本地镜像, 不拉取； Never：只使用本地镜像，从不拉取</span></span><br><span class=\"line\">          <span class=\"attr\">ports:</span></span><br><span class=\"line\">            <span class=\"bullet\">-</span> <span class=\"attr\">containerPort:</span> <span class=\"number\">8030</span> <span class=\"comment\">#容器对外开放端口</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-2-构建yaml\"><a href=\"#3-2-构建yaml\" class=\"headerlink\" title=\"3.2 构建yaml\"></a>3.2 构建yaml</h4><figure class=\"highlight livecodeserver\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl <span class=\"built_in\">create</span> -f demo.yaml</span><br><span class=\"line\">kubectl <span class=\"built_in\">get</span> pods</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/8216f086166b377dd66cc58fc7f1fdd3.png\"></p>\n<h4 id=\"3-3-测试设置的端口是否能访问\"><a href=\"#3-3-测试设置的端口是否能访问\" class=\"headerlink\" title=\"3.3 测试设置的端口是否能访问\"></a>3.3 测试设置的端口是否能访问</h4><figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl <span class=\"number\">127.0</span>.<span class=\"number\">0.1</span>:<span class=\"number\">30333</span>/<span class=\"keyword\">test</span>/<span class=\"keyword\">test</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/30061f1f137b9d29d935ea0187e719cd.png\"></p>\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/17bb6c973d722c6c000fca1e6067f34d.png\"></p>\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/ad4d12afac9a5ab859de9738d8dce57e.png\"></p>\n<h4 id=\"3-4-删除构建\"><a href=\"#3-4-删除构建\" class=\"headerlink\" title=\"3.4 删除构建\"></a>3.4 删除构建</h4><figure class=\"highlight maxima\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kubectl <span class=\"built_in\">delete</span> -f <span class=\"built_in\">demo</span>.yaml</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/ced075e1d6965dca434b4090459c7761.png\"></p>\n<h2 id=\"4-推送镜像到harbor\"><a href=\"#4-推送镜像到harbor\" class=\"headerlink\" title=\"4 推送镜像到harbor\"></a>4 推送镜像到harbor</h2><h4 id=\"4-1-新建自己的项目\"><a href=\"#4-1-新建自己的项目\" class=\"headerlink\" title=\"4.1 新建自己的项目\"></a>4.1 新建自己的项目</h4><p>我们的私有harbor地址：<a href=\"https://harbor.saas.xxx-ift.com/\">https://harbor.saas.xxx-ift.com/</a><br>账号密码是BIP</p>\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/a6b0f92fff0b97b321cdc220bdaa106c.png\"></p>\n<h4 id=\"4-2-在项目中标记镜像\"><a href=\"#4-2-在项目中标记镜像\" class=\"headerlink\" title=\"4.2 在项目中标记镜像\"></a>4.2 在项目中标记镜像</h4><figure class=\"highlight crmsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker <span class=\"keyword\">tag</span> <span class=\"title\">luozhanfeng</span>/demo:v1 harbor.saas.xxx-ift.com/luozhanfeng/demo:v1</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/a692570bc9745a21693c2b409ee9f200.png\"></p>\n<h4 id=\"4-3-安装证书\"><a href=\"#4-3-安装证书\" class=\"headerlink\" title=\"4.3 安装证书\"></a>4.3 安装证书</h4><h5 id=\"4-3-1-下载证书\"><a href=\"#4-3-1-下载证书\" class=\"headerlink\" title=\"4.3.1 下载证书\"></a>4.3.1 下载证书</h5><p><img src=\"https://img-blog.csdnimg.cn/img_convert/5d3c1acbcf8bd442ef9aa9d07d19c66b.png\"></p>\n<h5 id=\"4-3-2-放在-x2F-etc-x2F-pki-x2F-tls-x2F-certs-x2F-目录下\"><a href=\"#4-3-2-放在-x2F-etc-x2F-pki-x2F-tls-x2F-certs-x2F-目录下\" class=\"headerlink\" title=\"4.3.2 放在 &#x2F;etc&#x2F;pki&#x2F;tls&#x2F;certs&#x2F; 目录下\"></a>4.3.2 放在 &#x2F;etc&#x2F;pki&#x2F;tls&#x2F;certs&#x2F; 目录下</h5><figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd <span class=\"regexp\">/etc/</span>pki<span class=\"regexp\">/tls/</span>certs/</span><br><span class=\"line\">rz </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/4ffc22171626837b7db8bee88330f1b9.png\"></p>\n<h4 id=\"4-4-推送镜像到当前项目\"><a href=\"#4-4-推送镜像到当前项目\" class=\"headerlink\" title=\"4.4 推送镜像到当前项目\"></a>4.4 推送镜像到当前项目</h4><h5 id=\"4-4-1-登录harbor\"><a href=\"#4-4-1-登录harbor\" class=\"headerlink\" title=\"4.4.1 登录harbor\"></a>4.4.1 登录harbor</h5><figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">docker</span> login https://harbor.saas.xxx-ift.com</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"4-4-2-推送\"><a href=\"#4-4-2-推送\" class=\"headerlink\" title=\"4.4.2 推送\"></a>4.4.2 推送</h5><figure class=\"highlight armasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">docker</span> <span class=\"keyword\">push</span> harbor.saas.xxx-ift.com/luozhanfeng/demo:<span class=\"built_in\">v1</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/9322048e38b2625b06fd07c4139f78bf.png\"></p>\n<h2 id=\"5-排雷\"><a href=\"#5-排雷\" class=\"headerlink\" title=\"5 排雷\"></a>5 排雷</h2><h4 id=\"5-1-报错1\"><a href=\"#5-1-报错1\" class=\"headerlink\" title=\"5.1 报错1\"></a>5.1 报错1</h4><p><img src=\"https://img-blog.csdnimg.cn/img_convert/467618c51c217942312192f30e41b456.png\"></p>\n<p>1、需要修改docker.service</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim <span class=\"regexp\">/usr/</span>lib<span class=\"regexp\">/systemd/</span>system/docker.service</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>EnvironmentFile&#x3D;-&#x2F;etc&#x2F;sysconfig&#x2F;docker<br>ExecStart&#x3D;&#x2F;usr&#x2F;bin&#x2F;dockerd $OPTIONS</p>\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/379763c399783d2f0de73995335f8344.png\"></p>\n<p>2、修改&#x2F;etc&#x2F;docker&#x2F;daemon.json</p>\n<p>{<br>“insecure-registries”: [“<a href=\"http://192.168.19.4”/]\">http://192.168.19.4”\\]</a><br>}</p>\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/e66644cb11951f6599423eb1f7aea3d7.png\"></p>\n<p>然后重启docker即可</p>\n<figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"params\">system</span>ctl daemon-reload</span><br><span class=\"line\"><span class=\"params\">system</span>ctl restart docker.service</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"5-1-报错2\"><a href=\"#5-1-报错2\" class=\"headerlink\" title=\"5.1 报错2\"></a>5.1 报错2</h4><p>[root@test3 ~]# docker push 192.168.0.7&#x2F;gitlab&#x2F;gitlab_back:v1<br>The push refers to a repository [192.168.0.7&#x2F;gitlab&#x2F;gitlab_back]<br>Get <a href=\"https://192.168.0.7/v1/_ping\">https://192.168.0.7/v1/_ping</a>: read tcp 192.168.0.6:40306-&gt;192.168.0.7:443: read: connection reset by peer</p>\n<p>解决办法：<br>编辑vim &#x2F;etc&#x2F;sysconfig&#x2F;docker文件。如果没有则创建。</p>\n<p><img src=\"https://img-blog.csdnimg.cn/img_convert/8e3a2e4848a57a8072247a1d784a547f.png\"></p>\n<h2 id=\"6-资料网址\"><a href=\"#6-资料网址\" class=\"headerlink\" title=\"6 资料网址\"></a>6 资料网址</h2><p>docker推送镜像到harbor<br><a href=\"https://blog.51cto.com/lovejxs/2446037?source=dra\">https://blog.51cto.com/lovejxs/2446037?source=dra</a></p>\n<p>自签署ssl根证书 certificate signed by unknown authority<br><a href=\"https://segmentfault.com/q/1010000000938076\">https://segmentfault.com/q/1010000000938076</a></p>\n<p>docker push到私有仓库<br><a href=\"https://www.cnblogs.com/jifeng/p/9410003.html\">https://www.cnblogs.com/jifeng/p/9410003.html</a></p>\n<p>K8S部署SpringBoot应用<br><a href=\"https://blog.csdn.net/m0_37063785/article/details/101303898\">https://blog.csdn.net/m0_37063785/article/details/101303898</a></p>\n<p>k8s使用本地镜像<br><a href=\"https://blog.csdn.net/u010039418/article/details/86578420\">https://blog.csdn.net/u010039418/article/details/86578420</a></p>\n","text":"k8s部署springboot的demo项目1 准备jar包1.1 把你的springboot项目打包成可执行jar包 1.2 把jar包上传到Linux服务器...","permalink":"/post/OCI/k8s部署springboot的demo项目","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[{"name":"img","slug":"img","count":1,"path":"api/categories/img.json"},{"name":"OCI","slug":"img/OCI","count":1,"path":"api/categories/img/OCI.json"}],"tags":[{"name":"https","slug":"https","count":44,"path":"api/tags/https.json"},{"name":"blog","slug":"blog","count":3,"path":"api/tags/blog.json"},{"name":"csdnimg","slug":"csdnimg","count":1,"path":"api/tags/csdnimg.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#k8s%E9%83%A8%E7%BD%B2springboot%E7%9A%84demo%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">k8s部署springboot的demo项目</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E5%87%86%E5%A4%87jar%E5%8C%85\"><span class=\"toc-text\">1 准备jar包</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E6%9E%84%E5%BB%BAdocker%E9%95%9C%E5%83%8F\"><span class=\"toc-text\">2 构建docker镜像</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-1-%E7%BC%96%E5%86%99Dockerfile\"><span class=\"toc-text\">2.1 编写Dockerfile</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-2-%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BA\"><span class=\"toc-text\">2.2 开始构建</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-2-%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F\"><span class=\"toc-text\">2.2 查看镜像</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E9%83%A8%E7%BD%B2-k8s\"><span class=\"toc-text\">3 部署 k8s</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-1-%E7%BC%96%E5%86%99deployment%E5%92%8Cservice%E7%9A%84yaml\"><span class=\"toc-text\">3.1 编写deployment和service的yaml</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-2-%E6%9E%84%E5%BB%BAyaml\"><span class=\"toc-text\">3.2 构建yaml</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-3-%E6%B5%8B%E8%AF%95%E8%AE%BE%E7%BD%AE%E7%9A%84%E7%AB%AF%E5%8F%A3%E6%98%AF%E5%90%A6%E8%83%BD%E8%AE%BF%E9%97%AE\"><span class=\"toc-text\">3.3 测试设置的端口是否能访问</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-4-%E5%88%A0%E9%99%A4%E6%9E%84%E5%BB%BA\"><span class=\"toc-text\">3.4 删除构建</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-%E6%8E%A8%E9%80%81%E9%95%9C%E5%83%8F%E5%88%B0harbor\"><span class=\"toc-text\">4 推送镜像到harbor</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-1-%E6%96%B0%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">4.1 新建自己的项目</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-2-%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%A0%87%E8%AE%B0%E9%95%9C%E5%83%8F\"><span class=\"toc-text\">4.2 在项目中标记镜像</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-3-%E5%AE%89%E8%A3%85%E8%AF%81%E4%B9%A6\"><span class=\"toc-text\">4.3 安装证书</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-3-1-%E4%B8%8B%E8%BD%BD%E8%AF%81%E4%B9%A6\"><span class=\"toc-text\">4.3.1 下载证书</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-3-2-%E6%94%BE%E5%9C%A8-x2F-etc-x2F-pki-x2F-tls-x2F-certs-x2F-%E7%9B%AE%E5%BD%95%E4%B8%8B\"><span class=\"toc-text\">4.3.2 放在 &#x2F;etc&#x2F;pki&#x2F;tls&#x2F;certs&#x2F; 目录下</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-4-%E6%8E%A8%E9%80%81%E9%95%9C%E5%83%8F%E5%88%B0%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">4.4 推送镜像到当前项目</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-4-1-%E7%99%BB%E5%BD%95harbor\"><span class=\"toc-text\">4.4.1 登录harbor</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-4-2-%E6%8E%A8%E9%80%81\"><span class=\"toc-text\">4.4.2 推送</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#5-%E6%8E%92%E9%9B%B7\"><span class=\"toc-text\">5 排雷</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5-1-%E6%8A%A5%E9%94%991\"><span class=\"toc-text\">5.1 报错1</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5-1-%E6%8A%A5%E9%94%992\"><span class=\"toc-text\">5.1 报错2</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#6-%E8%B5%84%E6%96%99%E7%BD%91%E5%9D%80\"><span class=\"toc-text\">6 资料网址</span></a></li></ol></li></ol>","author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Redis 中常见的集群部署方案","uid":"b7cb565dcfadfaf74b2fbb30bbd40cf9","slug":"MIDDLEWARE/Redis 中常见的集群部署方案","date":"2023-02-15T19:10:53.000Z","updated":"2025-09-30T03:26:50.424Z","comments":true,"path":"api/articles/MIDDLEWARE/Redis 中常见的集群部署方案.json","keywords":"XuGuangSheng","cover":"/covers/redis.jpg","text":"Redis 中常见的集群部署方案Redis 的高可用集群前言这里来了解一下，Redis 中常见的集群方案 几种常用的集群方案 主从集群模式 哨兵机制 切片集群(...","permalink":"/post/MIDDLEWARE/Redis 中常见的集群部署方案","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[{"name":"Redis","slug":"Redis","count":1,"path":"api/categories/Redis.json"},{"name":"MIDDLEWARE","slug":"Redis/MIDDLEWARE","count":1,"path":"api/categories/Redis/MIDDLEWARE.json"}],"tags":[{"name":"redis","slug":"redis","count":2,"path":"api/tags/redis.json"},{"name":"key","slug":"key","count":1,"path":"api/tags/key.json"},{"name":"Key","slug":"Key","count":1,"path":"api/tags/Key.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"一行js代码识别Selenium+Webdriver与反识别","uid":"a53c723ef12f17b502c1ffd648c4aabe","slug":"WORK/一行js代码识别Selenium+Webdriver与反识别","date":"2023-01-10T16:14:41.000Z","updated":"2025-09-30T03:27:02.643Z","comments":true,"path":"api/articles/WORK/一行js代码识别Selenium+Webdriver与反识别.json","keywords":"XuGuangSheng","cover":"/covers/jsselenium-webdriver.jpg","text":"一行js代码识别Selenium+Webdriver与反识别一行js代码识别Selenium+Webdriver有不少朋友在开发爬虫的过程中喜欢使用Seleni...","permalink":"/post/WORK/一行js代码识别Selenium+Webdriver与反识别","photos":[],"count_time":{"symbolsCount":"9.6k","symbolsTime":"9 mins."},"categories":[{"name":"https","slug":"https","count":12,"path":"api/categories/https.json"},{"name":"WORK","slug":"https/WORK","count":1,"path":"api/categories/https/WORK.json"}],"tags":[{"name":"true","slug":"true","count":2,"path":"api/tags/true.json"},{"name":"webdriver","slug":"webdriver","count":1,"path":"api/tags/webdriver.json"},{"name":"Selenium","slug":"Selenium","count":1,"path":"api/tags/Selenium.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}