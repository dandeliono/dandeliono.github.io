{"title":"docker-compose部署flink集群","uid":"96cd93f7633628e16d6fdcc58320aac4","slug":"OCI/docker-compose部署flink集群","date":"2021-11-13T11:41:36.000Z","updated":"2025-12-05T01:47:55.274Z","comments":true,"path":"api/articles/OCI/docker-compose部署flink集群.json","keywords":"XuGuangSheng","cover":"/covers/docker-composeflink.jpg","content":"<h1 id=\"docker-compose部署flink集群\"><a href=\"#docker-compose部署flink集群\" class=\"headerlink\" title=\"docker-compose部署flink集群\"></a>docker-compose部署flink集群</h1><h4 id=\"flink-集群部署\"><a href=\"#flink-集群部署\" class=\"headerlink\" title=\"flink 集群部署\"></a>flink 集群部署</h4><ul>\n<li>拉取 flink 镜像</li>\n</ul>\n<figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">docker pull flink</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>自定义创建目录（例如 &#x2F; usr&#x2F;local&#x2F;flink&#x2F;flink-docker）</li>\n</ul>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mdkir <span class=\"regexp\">/usr/</span>local<span class=\"regexp\">/flink/</span>flink-docker</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>在上述目录，创建文件 docker-compose.yml</li>\n</ul>\n<figure class=\"highlight dts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">version:</span> <span class=\"string\">&quot;2.1&quot;</span></span><br><span class=\"line\"><span class=\"symbol\">services:</span></span><br><span class=\"line\"><span class=\"symbol\">  jobmanager:</span></span><br><span class=\"line\"><span class=\"symbol\">    image:</span> flink</span><br><span class=\"line\"><span class=\"symbol\">    expose:</span></span><br><span class=\"line\">      - <span class=\"string\">&quot;6123&quot;</span></span><br><span class=\"line\"><span class=\"symbol\">    ports:</span></span><br><span class=\"line\">      - <span class=\"string\">&quot;8081:8081&quot;</span></span><br><span class=\"line\"><span class=\"symbol\">    command:</span> jobmanager</span><br><span class=\"line\"><span class=\"symbol\">    environment:</span></span><br><span class=\"line\">      - JOB_MANAGER_RPC_ADDRESS=jobmanager</span><br><span class=\"line\"><span class=\"symbol\">    volumes:</span></span><br><span class=\"line\">      - <span class=\"keyword\">/usr/</span>local<span class=\"keyword\">/flink/</span>flink-docker<span class=\"keyword\">/conf/</span>job/flink-conf.yaml:<span class=\"keyword\">/opt/</span>flink<span class=\"keyword\">/conf/</span>flink-conf.yaml</span><br><span class=\"line\"><span class=\"symbol\">    restart:</span> always</span><br><span class=\"line\"><span class=\"symbol\"> </span></span><br><span class=\"line\"><span class=\"symbol\">  taskmanager:</span></span><br><span class=\"line\"><span class=\"symbol\">    image:</span> flink</span><br><span class=\"line\"><span class=\"symbol\">    expose:</span></span><br><span class=\"line\">      - <span class=\"string\">&quot;6121&quot;</span></span><br><span class=\"line\">      - <span class=\"string\">&quot;6122&quot;</span></span><br><span class=\"line\"><span class=\"symbol\">    depends_on:</span></span><br><span class=\"line\">      - jobmanager</span><br><span class=\"line\"><span class=\"symbol\">    command:</span> taskmanager</span><br><span class=\"line\"><span class=\"symbol\">    links:</span></span><br><span class=\"line\">      - <span class=\"string\">&quot;jobmanager:jobmanager&quot;</span></span><br><span class=\"line\"><span class=\"symbol\">    environment:</span></span><br><span class=\"line\">      - JOB_MANAGER_RPC_ADDRESS=jobmanager</span><br><span class=\"line\"><span class=\"symbol\">    volumes:</span></span><br><span class=\"line\">      - <span class=\"keyword\">/usr/</span>local<span class=\"keyword\">/flink/</span>flink-docker<span class=\"keyword\">/conf/</span>task/flink-conf.yaml:<span class=\"keyword\">/opt/</span>flink<span class=\"keyword\">/conf/</span>flink-conf.yaml</span><br><span class=\"line\"><span class=\"symbol\">    restart:</span> always</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>自定义创建 flink 挂载配置目录（例如 &#x2F; usr&#x2F;local&#x2F;flink&#x2F;flink-docker&#x2F;conf）</li>\n</ul>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir <span class=\"regexp\">/usr/</span>local<span class=\"regexp\">/flink/</span>flink-docker<span class=\"regexp\">/conf/</span>job</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir <span class=\"regexp\">/usr/</span>local<span class=\"regexp\">/flink/</span>flink-docker<span class=\"regexp\">/conf/</span><span class=\"keyword\">task</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>将 flink-conf.yaml 分别放入上述两个文件中</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">################################################################################</span></span><br><span class=\"line\"><span class=\"comment\">#  Licensed to the Apache Software Foundation (ASF) under one</span></span><br><span class=\"line\"><span class=\"comment\">#  or more contributor license agreements.  See the NOTICE file</span></span><br><span class=\"line\"><span class=\"comment\">#  distributed with this work for additional information</span></span><br><span class=\"line\"><span class=\"comment\">#  regarding copyright ownership.  The ASF licenses this file</span></span><br><span class=\"line\"><span class=\"comment\">#  to you under the Apache License, Version 2.0 (the</span></span><br><span class=\"line\"><span class=\"comment\">#  &quot;License&quot;); you may not use this file except in compliance</span></span><br><span class=\"line\"><span class=\"comment\">#  with the License.  You may obtain a copy of the License at</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#      http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#  Unless required by applicable law or agreed to in writing, software</span></span><br><span class=\"line\"><span class=\"comment\">#  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class=\"line\"><span class=\"comment\">#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class=\"line\"><span class=\"comment\">#  See the License for the specific language governing permissions and</span></span><br><span class=\"line\"><span class=\"comment\"># limitations under the License.</span></span><br><span class=\"line\"><span class=\"comment\">################################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># Common</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The external address of the host on which the JobManager runs and can be</span></span><br><span class=\"line\"><span class=\"comment\"># reached by the TaskManagers and any clients which want to connect. This setting</span></span><br><span class=\"line\"><span class=\"comment\"># is only used in Standalone mode and may be overwritten on the JobManager side</span></span><br><span class=\"line\"><span class=\"comment\"># by specifying the --host &lt;hostname&gt; parameter of the bin/jobmanager.sh executable.</span></span><br><span class=\"line\"><span class=\"comment\"># In high availability mode, if you use the bin/start-cluster.sh script and setup</span></span><br><span class=\"line\"><span class=\"comment\"># the conf/masters file, this will be taken care of automatically. Yarn/Mesos</span></span><br><span class=\"line\"><span class=\"comment\"># automatically configure the host name based on the hostname of the node where the</span></span><br><span class=\"line\"><span class=\"comment\"># JobManager runs.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobmanager.rpc.address:</span> <span class=\"string\">jobmanager</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The RPC port where the JobManager is reachable.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobmanager.rpc.port:</span> <span class=\"number\">6123</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The total process memory size for the JobManager.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Note this accounts for all memory usage within the JobManager process, including JVM metaspace and other overhead.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobmanager.memory.process.size:</span> <span class=\"string\">4096m</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The total process memory size for the TaskManager.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Note this accounts for all memory usage within the TaskManager process, including JVM metaspace and other overhead.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">taskmanager.memory.process.size:</span> <span class=\"string\">16384m</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># To exclude JVM metaspace and overhead, please, use total Flink memory size instead of &#x27;taskmanager.memory.process.size&#x27;.</span></span><br><span class=\"line\"><span class=\"comment\"># It is not recommended to set both &#x27;taskmanager.memory.process.size&#x27; and Flink memory.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># taskmanager.memory.flink.size: 1280m</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The number of task slots that each TaskManager offers. Each slot runs one parallel pipeline.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">taskmanager.numberOfTaskSlots:</span> <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The parallelism used for programs that did not specify and other parallelism.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">parallelism.default:</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The default file system scheme and authority.</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># By default file paths without scheme are interpreted relative to the local</span></span><br><span class=\"line\"><span class=\"comment\"># root file system &#x27;file:///&#x27;. Use this to override the default and interpret</span></span><br><span class=\"line\"><span class=\"comment\"># relative paths relative to a different file system,</span></span><br><span class=\"line\"><span class=\"comment\"># for example &#x27;hdfs://mynamenode:12345&#x27;</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># fs.default-scheme</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># High Availability</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The high-availability mode. Possible options are &#x27;NONE&#x27; or &#x27;zookeeper&#x27;.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># high-availability: zookeeper</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The path where metadata for master recovery is persisted. While ZooKeeper stores</span></span><br><span class=\"line\"><span class=\"comment\"># the small ground truth for checkpoint and leader election, this location stores</span></span><br><span class=\"line\"><span class=\"comment\"># the larger objects, like persisted dataflow graphs.</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># Must be a durable file system that is accessible from all nodes</span></span><br><span class=\"line\"><span class=\"comment\"># (like HDFS, S3, Ceph, nfs, ...) </span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># high-availability.storageDir: hdfs:///flink/ha/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The list of ZooKeeper quorum peers that coordinate the high-availability</span></span><br><span class=\"line\"><span class=\"comment\"># setup. This must be a list of the form:</span></span><br><span class=\"line\"><span class=\"comment\"># &quot;host1:clientPort,host2:clientPort,...&quot; (default clientPort: 2181)</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># high-availability.zookeeper.quorum: localhost:2181</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ACL options are based on https://zookeeper.apache.org/doc/r3.1.2/zookeeperProgrammers.html#sc_BuiltinACLSchemes</span></span><br><span class=\"line\"><span class=\"comment\"># It can be either &quot;creator&quot; (ZOO_CREATE_ALL_ACL) or &quot;open&quot; (ZOO_OPEN_ACL_UNSAFE)</span></span><br><span class=\"line\"><span class=\"comment\"># The default value is &quot;open&quot; and it can be changed to &quot;creator&quot; if ZK security is enabled</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># high-availability.zookeeper.client.acl: open</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># Fault tolerance and checkpointing</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The backend that will be used to store operator state checkpoints if</span></span><br><span class=\"line\"><span class=\"comment\"># checkpointing is enabled.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Supported backends are &#x27;jobmanager&#x27;, &#x27;filesystem&#x27;, &#x27;rocksdb&#x27;, or the</span></span><br><span class=\"line\"><span class=\"comment\"># &lt;class-name-of-factory&gt;.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># state.backend: filesystem</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Directory for checkpoints filesystem, when using any of the default bundled</span></span><br><span class=\"line\"><span class=\"comment\"># state backends.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># state.checkpoints.dir: hdfs://namenode-host:port/flink-checkpoints</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Default target directory for savepoints, optional.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#state.savepoints.dir: file:/tmp/savepoint</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Flag to enable/disable incremental checkpoints for backends that</span></span><br><span class=\"line\"><span class=\"comment\"># support incremental checkpoints (like the RocksDB state backend). </span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># state.backend.incremental: false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The failover strategy, i.e., how the job computation recovers from task failures.</span></span><br><span class=\"line\"><span class=\"comment\"># Only restart tasks that may have been affected by the task failure, which typically includes</span></span><br><span class=\"line\"><span class=\"comment\"># downstream tasks and potentially upstream tasks if their produced data is no longer available for consumption.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobmanager.execution.failover-strategy:</span> <span class=\"string\">region</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># Rest &amp; web frontend</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The port to which the REST client connects to. If rest.bind-port has</span></span><br><span class=\"line\"><span class=\"comment\"># not been specified, then the server will bind to this port as well.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#rest.port: 8081</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The address to which the REST client will connect to</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#rest.address: 0.0.0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Port range for the REST and web server to bind to.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#rest.bind-port: 8080-8090</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The address that the REST &amp; web server binds to</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#rest.bind-address: 0.0.0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Flag to specify whether job submission is enabled from the web-based</span></span><br><span class=\"line\"><span class=\"comment\"># runtime monitor. Uncomment to disable.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#web.submit.enable: false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># Advanced</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Override the directories for temporary files. If not specified, the</span></span><br><span class=\"line\"><span class=\"comment\"># system-specific Java temporary directory (java.io.tmpdir property) is taken.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># For framework setups on Yarn or Mesos, Flink will automatically pick up the</span></span><br><span class=\"line\"><span class=\"comment\"># containers&#x27; temp directories without any need for configuration.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Add a delimited list for multiple directories, using the system directory</span></span><br><span class=\"line\"><span class=\"comment\"># delimiter (colon &#x27;:&#x27; on unix) or a comma, e.g.:</span></span><br><span class=\"line\"><span class=\"comment\">#     /data1/tmp:/data2/tmp:/data3/tmp</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># <span class=\"doctag\">Note:</span> Each directory entry is read from and written to by a different I/O</span></span><br><span class=\"line\"><span class=\"comment\"># thread. You can include the same directory multiple times in order to create</span></span><br><span class=\"line\"><span class=\"comment\"># multiple I/O threads against that directory. This is for example relevant for</span></span><br><span class=\"line\"><span class=\"comment\"># high-throughput RAIDs.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># io.tmp.dirs: /tmp</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The classloading resolve order. Possible values are &#x27;child-first&#x27; (Flink&#x27;s default)</span></span><br><span class=\"line\"><span class=\"comment\"># and &#x27;parent-first&#x27; (Java&#x27;s default).</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Child first classloading allows users to use different dependency/library</span></span><br><span class=\"line\"><span class=\"comment\"># versions in their application than those in the classpath. Switching back</span></span><br><span class=\"line\"><span class=\"comment\"># to &#x27;parent-first&#x27; may help with debugging dependency issues.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># classloader.resolve-order: child-first</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The amount of memory going to the network stack. These numbers usually need </span></span><br><span class=\"line\"><span class=\"comment\"># no tuning. Adjusting them may be necessary in case of an &quot;Insufficient number</span></span><br><span class=\"line\"><span class=\"comment\"># of network buffers&quot; error. The default min is 64MB, the default max is 1GB.</span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># taskmanager.memory.network.fraction: 0.1</span></span><br><span class=\"line\"><span class=\"comment\"># taskmanager.memory.network.min: 64mb</span></span><br><span class=\"line\"><span class=\"comment\"># taskmanager.memory.network.max: 1gb</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># Flink Cluster Security Configuration</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Kerberos authentication for various components - Hadoop, ZooKeeper, and connectors -</span></span><br><span class=\"line\"><span class=\"comment\"># may be enabled in four steps:</span></span><br><span class=\"line\"><span class=\"comment\"># 1. configure the local krb5.conf file</span></span><br><span class=\"line\"><span class=\"comment\"># 2. provide Kerberos credentials (either a keytab or a ticket cache w/ kinit)</span></span><br><span class=\"line\"><span class=\"comment\"># 3. make the credentials available to various JAAS login contexts</span></span><br><span class=\"line\"><span class=\"comment\"># 4. configure the connector to use JAAS/SASL</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The below configure how Kerberos credentials are provided. A keytab will be used instead of</span></span><br><span class=\"line\"><span class=\"comment\"># a ticket cache if the keytab path and principal are set.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># security.kerberos.login.use-ticket-cache: true</span></span><br><span class=\"line\"><span class=\"comment\"># security.kerberos.login.keytab: /path/to/kerberos/keytab</span></span><br><span class=\"line\"><span class=\"comment\"># security.kerberos.login.principal: flink-user</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The configuration below defines which JAAS login contexts</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># security.kerberos.login.contexts: Client,KafkaClient</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># ZK Security Configuration</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Below configurations are applicable if ZK ensemble is configured for security</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Override below configuration to provide custom ZK service name if configured</span></span><br><span class=\"line\"><span class=\"comment\"># zookeeper.sasl.service-name: zookeeper</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The configuration below must match one of the values set in &quot;security.kerberos.login.contexts&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># zookeeper.sasl.login-context-name: Client</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"><span class=\"comment\"># HistoryServer</span></span><br><span class=\"line\"><span class=\"comment\">#==============================================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The HistoryServer is started and stopped via bin/historyserver.sh (start|stop)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Directory to upload completed jobs to. Add this directory to the list of</span></span><br><span class=\"line\"><span class=\"comment\"># monitored directories of the HistoryServer as well (see below).</span></span><br><span class=\"line\"><span class=\"comment\">#jobmanager.archive.fs.dir: hdfs:///completed-jobs/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The address under which the web-based HistoryServer listens.</span></span><br><span class=\"line\"><span class=\"comment\">#historyserver.web.address: 0.0.0.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The port under which the web-based HistoryServer listens.</span></span><br><span class=\"line\"><span class=\"comment\">#historyserver.web.port: 8082</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Comma separated list of directories to monitor for completed jobs.</span></span><br><span class=\"line\"><span class=\"comment\">#historyserver.archive.fs.dir: hdfs:///completed-jobs/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Interval in milliseconds for refreshing the monitored directories.</span></span><br><span class=\"line\"><span class=\"comment\">#historyserver.archive.fs.refresh-interval: 10000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">blob.server.port:</span> <span class=\"number\">6124</span></span><br><span class=\"line\"><span class=\"attr\">query.server.port:</span> <span class=\"number\">6125</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>切换到之前自定义的 docker-compose 目录</li>\n</ul>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd <span class=\"regexp\">/usr/</span>local<span class=\"regexp\">/flink/</span>flink-docker</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>拉起 flink 集群</li>\n</ul>\n<figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">docker-compose up -d</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>查看日志, 确定是否启动成功</li>\n</ul>\n<figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">docker-compose logs</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>若想配置多个 task-manager</li>\n</ul>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose scale <span class=\"attribute\">taskmanager</span>=2</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>都配置好后，就可以访问 ip:8081 进行查看了</li>\n</ul>\n","text":"docker-compose部署flink集群flink 集群部署 拉取 flink 镜像 12docker pull flink 自定义创建目录（例如 / u...","permalink":"/post/OCI/docker-compose部署flink集群","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"flink","slug":"flink","count":2,"path":"api/categories/flink.json"},{"name":"OCI","slug":"flink/OCI","count":1,"path":"api/categories/flink/OCI.json"}],"tags":[{"name":"docker","slug":"docker","count":4,"path":"api/tags/docker.json"},{"name":"compose","slug":"compose","count":1,"path":"api/tags/compose.json"},{"name":"集群","slug":"集群","count":1,"path":"api/tags/集群.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#docker-compose%E9%83%A8%E7%BD%B2flink%E9%9B%86%E7%BE%A4\"><span class=\"toc-text\">docker-compose部署flink集群</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#flink-%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2\"><span class=\"toc-text\">flink 集群部署</span></a></li></ol></li></ol></li></ol></li></ol>","author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"Elasticsearch系统常见问题","uid":"f086d547e55f7aeb852f476ef6c33b8e","slug":"MIDDLEWARE/Elasticsearch系统常见问题","date":"2021-11-17T10:00:10.000Z","updated":"2025-12-05T01:47:25.787Z","comments":true,"path":"api/articles/MIDDLEWARE/Elasticsearch系统常见问题.json","keywords":"XuGuangSheng","cover":"/covers/elasticsearch.jpg","text":"Elasticsearch系统常见问题如何查看 Es 安装了哪些插件可以使用下面这个 API，会列出每个节点安装的插件列表。 线程池队列满导致错误在这种场景下 ...","permalink":"/post/MIDDLEWARE/Elasticsearch系统常见问题","photos":[],"count_time":{"symbolsCount":"8.7k","symbolsTime":"8 mins."},"categories":[{"name":"shard","slug":"shard","count":1,"path":"api/categories/shard.json"},{"name":"MIDDLEWARE","slug":"shard/MIDDLEWARE","count":1,"path":"api/categories/shard/MIDDLEWARE.json"}],"tags":[{"name":"search","slug":"search","count":2,"path":"api/tags/search.json"},{"name":"index","slug":"index","count":1,"path":"api/tags/index.json"},{"name":"segment","slug":"segment","count":1,"path":"api/tags/segment.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"如何优雅地记录操作日志？","uid":"bec62911910e4566d1eb24b159beea23","slug":"LINUX/如何优雅地记录操作日志？","date":"2021-11-03T14:13:48.000Z","updated":"2025-12-05T01:47:15.114Z","comments":true,"path":"api/articles/LINUX/如何优雅地记录操作日志？.json","keywords":"XuGuangSheng","cover":"/covers/8566a8fc21ff.jpg","text":"如何优雅地记录操作日志？操作日志几乎存在于每个系统中，而这些系统都有记录操作日志的一套 API。操作日志和系统日志不一样，操作日志必须要做到简单易懂。所以如何让...","permalink":"/post/LINUX/如何优雅地记录操作日志？","photos":[],"count_time":{"symbolsCount":"27k","symbolsTime":"24 mins."},"categories":[{"name":"SpEL","slug":"SpEL","count":1,"path":"api/categories/SpEL.json"},{"name":"LINUX","slug":"SpEL/LINUX","count":1,"path":"api/categories/SpEL/LINUX.json"}],"tags":[{"name":"https","slug":"https","count":44,"path":"api/tags/https.json"},{"name":"com","slug":"com","count":26,"path":"api/tags/com.json"},{"name":"AOP","slug":"AOP","count":1,"path":"api/tags/AOP.json"}],"author":{"name":"dandeliono","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/29496357","link":"/","description":"永远相信美好的事情即将发生","socials":{"github":"https://github.com/dandeliono","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}